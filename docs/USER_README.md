# MUS Booking System - 使用说明

## 📖 简介

这是一个独立的可执行文件版本，无需安装 Python 即可运行。

**版本**: 2.10.0
**打包日期**: 2025-10-25

---

## 🚀 快速开始

### 第一次使用

1. **解压文件**
   - 将收到的压缩包解压到任意位置
   - 建议放在容易找到的位置（如桌面或 `C:\Program Files\`）

2. **准备工作**
   - ✅ 安装并启动 **Reqable** 代理软件（端口 9000）
   - ✅ 连接 **AnyConnect VPN** 到学校网络
   - ✅ 确保网络连接正常

3. **启动程序**
   - 双击 `MUS_Booking.exe`
   - 程序将自动打开"魔丸"窗口

4. **首次配置**
   - 点击左上角的"设置"按钮（像文件夹的图标）
   - 填写以下信息：
     * 学号（user_id）
     * 密码（user_password）- 用于自动登录
     * 姓名（user_name）
     * 邮箱（user_email）
     * 电话（user_phone）
     * 主题（theme）- 默认"练琴"
   - 点击"保存"

5. **添加预订请求**
   - 点击"＋ 添加一组预定请求"
   - 选择：
     * 琴房（地点）
     * 日期
     * 开始时间
     * 结束时间
   - 可以添加多个预订请求

6. **开始预订**
   - 设置"启动时间"（或勾选"立即启动"）
   - 点击大大的"开始"按钮
   - 程序会自动登录获取 Cookie，然后开始预订

---

## 🔧 功能说明

### 1. 自动登录获取 Cookie

- 点击"开始"后，程序会自动：
  1. 打开浏览器窗口
  2. 填写学号和密码
  3. 自动提交登录
  4. 捕获 Cookie
  5. 关闭浏览器窗口

- **无需手动操作**，等待即可

### 2. 智能代理检测

- 程序启动时自动检测网络配置
- 优先检测 Reqable 代理（127.0.0.1:9000）
- 如果未找到代理，会尝试直接连接（VPN）

- **手动检测**：点击"Cookie"按钮 → "自动检测代理"

### 3. 定时预订

- **立即启动**：勾选后，点"开始"立即执行
- **定时启动**：设置启动时间，程序会在指定时间自动开始

### 4. 多琴房批量预订

- 可以添加多个预订请求
- 程序会按顺序执行
- 超过 2 小时的时段会自动拆分

---

## ⚠️ 常见问题

### Q1: 程序无法启动，提示缺少 DLL

**原因**：缺少 Visual C++ 运行库

**解决方法**：
1. 下载并安装：https://aka.ms/vs/17/release/vc_redist.x64.exe
2. 重启电脑后再试

### Q2: Cookie 获取失败

**可能原因**：
- ❌ Reqable 未启动或端口不是 9000
- ❌ AnyConnect VPN 未连接
- ❌ 学号或密码错误
- ❌ 网络连接���题

**解决方法**：
1. 检查 Reqable 是否运行（端口 9000）
2. 检查 AnyConnect VPN 连接状态
3. 在"设置"中确认学号、密码正确
4. 查看日志窗口的详细错误信息

### Q3: 预订失败，提示"Cookie 过期"

**原因**：Cookie 已失效

**解决方法**：
- 重新点击"开始"，程序会自动获取新 Cookie

### Q4: 预订失败，提示"请求失败"

**可能原因**：
- ❌ 网络连接问题
- ❌ 代理设置错误
- ❌ VPN 断开

**解决方法**：
1. 检查网络连接
2. 重新启动 Reqable
3. 重新连接 AnyConnect VPN
4. 点击"Cookie"按钮 → "自动检测代理"

### Q5: 预订失败，提示"手速太慢"

**原因**：琴房已被其他人预订

**解决方法**：
- 选择其他琴房或时段
- 在开放预订的瞬间启动程序（提前设置好定时）

### Q6: 杀毒软件报毒

**原因**：这是误报，打包的程序经常被误报

**解决方法**：
- 添加到信任列表/白名单
- 或临时关闭杀毒软件

---

## 💡 使用技巧

### 技巧 1：提前准备

- 在开放预订前 5-10 分钟：
  1. 启动 Reqable
  2. 连接 AnyConnect VPN
  3. 打开程序并设置好预订信息
  4. 设��定时启动时间为开放瞬间
  5. 点击"开始"，等待自动执行

### 技巧 2：批量预订

- 添加多个琴房作为备选
- 程序会按顺序尝试
- 一旦成功会停止

### 技巧 3：定期更新 Cookie

- Cookie 会过期（通常几小时或几天）
- 建议每次预订前重新获取

### 技巧 4：保存配置

- 所有设置自动保存在 `config.yaml`
- 下次打开程序会自动加载
- 可以手动编辑该文件（YAML 格式）

---

## 📁 文件说明

```
MUS_Booking/
├── MUS_Booking.exe       # 主程序（双击启动）
├── _internal/            # 运行时依赖（不要删除）
├── resources/            # 资源文件
│   └── CCA.ico          # 程序图标
├── config.yaml          # 配置文件（自动生成）
└── BUILD_README.md      # 构建说明（可删除）
```

**注意**：
- ❌ 不要删除或移动 `_internal/` 文件夹
- ❌ 不要单独移动 `MUS_Booking.exe`
- ✅ 可以创建桌面快捷方式

---

## 🔐 隐私说明

- 学号、密码等信息仅保存在本地 `config.yaml`
- 不会上传到任何服务器
- 仅用于自动登录学校系统

---

## 📞 技术支持

如果遇到无法解决的问题：

1. 查看程序底部的"运行日志"窗口
2. 截图错误信息
3. 联系开发者

---

## 📝 更新日志

### v2.10.0 (2025-10-25)
- ✅ 独立可执行文件版本
- ✅ 包含所有依赖，无需安装 Python
- ✅ 自动登录获取 Cookie
- ✅ 智能代理检测
- ✅ 定时预订功能
- ✅ 多琴房批量预订

---

**祝预订顺利！🎉**
